<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="http://github.com/wearefractal/vinyl-fs">vinyl-fs (v2.4.4)</a>
</h1>
<h4>Vinyl adapter for the file system</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.vinyl-fs">module vinyl-fs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.dest">
            function <span class="apidocSignatureSpan">vinyl-fs.</span>dest
            <span class="apidocSignatureSpan">(outFolder, opt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.src">
            function <span class="apidocSignatureSpan">vinyl-fs.</span>src
            <span class="apidocSignatureSpan">(glob, opt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.symlink">
            function <span class="apidocSignatureSpan">vinyl-fs.</span>symlink
            <span class="apidocSignatureSpan">(outFolder, opt)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">vinyl-fs.</span>fileOperations</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.vinyl-fs.fileOperations">module vinyl-fs.fileOperations</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.closeFd">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>closeFd
            <span class="apidocSignatureSpan">(propagatedErr, fd, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.getModeDiff">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>getModeDiff
            <span class="apidocSignatureSpan">(fsMode, vinylMode)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.getTimesDiff">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>getTimesDiff
            <span class="apidocSignatureSpan">(fsStat, vinylStat)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.isOwner">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>isOwner
            <span class="apidocSignatureSpan">(fsStat)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.updateMetadata">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>updateMetadata
            <span class="apidocSignatureSpan">(fd, file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.vinyl-fs.fileOperations.writeFile">
            function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>writeFile
            <span class="apidocSignatureSpan">(path, data, options, callback)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.vinyl-fs" id="apidoc.module.vinyl-fs">module vinyl-fs</a></h1>


    <h2>
        <a href="#apidoc.element.vinyl-fs.dest" id="apidoc.element.vinyl-fs.dest">
        function <span class="apidocSignatureSpan">vinyl-fs.</span>dest
        <span class="apidocSignatureSpan">(outFolder, opt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function dest(outFolder, opt) {
  if (!opt) {
    opt = {};
  }

  function saveFile(file, enc, cb) {
    prepareWrite(outFolder, file, opt, function(err, writePath) {
      if (err) {
        return cb(err);
      }
      writeContents(writePath, file, cb);
    });
  }

  var saveStream = through2.obj(opt, saveFile);
  if (!opt.sourcemaps) {
    // Sink the save stream to start flowing
    // Do this on nextTick, it will flow at slowest speed of piped streams
    process.nextTick(sink(saveStream));

    return saveStream;
  }

  var sourcemapOpt = opt.sourcemaps;
  if (typeof sourcemapOpt === 'boolean') {
    sourcemapOpt = {};
  }
  if (typeof sourcemapOpt === 'string') {
    sourcemapOpt = {
      path: sourcemapOpt,
    };
  }

  var mapStream = sourcemaps.write(sourcemapOpt.path, sourcemapOpt);
  var outputStream = duplexify.obj(mapStream, saveStream);
  mapStream.pipe(saveStream);

  // Sink the output stream to start flowing
  // Do this on nextTick, it will flow at slowest speed of piped streams
  process.nextTick(sink(outputStream));

  return outputStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
- [103bb8c](https://github.com/gulpjs/vinyl-fs/commit/103bb8ca0b16e888ee44146603d5591220e228f4) update glob-watcher (@contra)
- [a319889](https://github.com/gulpjs/vinyl-fs/commit/a319889b9cbad1db0097d041ad02e0e2f76640bf) check src and dest args, closes #
8 (@contra)
- [671197a](https://github.com/gulpjs/vinyl-fs/commit/671197a54ddda0277abdc0c1c9fce27cc8ab9b86) drop support for 0.9 (@contra)
- [f89e03e](https://github.com/gulpjs/vinyl-fs/commit/f89e03e62cb62dc6c28d0ebe6f146123be2232a7) 0.1.0 (@contra)
- [bb34369](https://github.com/gulpjs/vinyl-fs/commit/bb343692f3bbeab08b40b4bb1ee20af7205f2837) comment (@contra)
- [c1c866a](https://github.com/gulpjs/vinyl-fs/commit/c1c866a5277038056d52fb106b2bca8cea430e59) mergit (@contra)
- [cc81580](https://github.com/gulpjs/vinyl-fs/commit/cc81580a4818e2260a367c54bdcc42b0b4d0a5cc) respect file modes in dest, add
mode option to dest (@contra)
- [#10](https://github.com/gulpjs/vinyl-fs/pull/10) Allow piping streaming vinyls through multiple .<span class="apidocCodeKeywordSpan
">dest</span>()'s (@hughsk)
- [d5566b2](https://github.com/gulpjs/vinyl-fs/commit/d5566b213b7e90a94b20aad35d4c08b2861c8247) Use ./src/streamFile for re-streaming
 .dest() streams (@hughsk)
- [868a3ec](https://github.com/gulpjs/vinyl-fs/commit/868a3ecc7945e798ee702cc30c5bcfff2af3ecd5) Allow piping streaming vinyls through
 multiple .dest()'s (@hughsk)
- [191d4ae](https://github.com/gulpjs/vinyl-fs/commit/191d4ae3672c76eb0cf0d46a2404c8e60e587d85) update file paths as they cruise
 through .dest (@contra)
- [cb69aa6](https://github.com/gulpjs/vinyl-fs/commit/cb69aa6c7ead7a435067fdfc89f89cd8af1215d4) cleanup (@contra)
- [f50d669](https://github.com/gulpjs/vinyl-fs/commit/f50d669a968f6f69ef07a0cc34b11704829c9c9f) add tests for relative cwd (@contra
)
- [39dfc18](https://github.com/gulpjs/vinyl-fs/commit/39dfc189367154136718fa0958712b1b14ea5e5a) fix tests (@contra)
- [60dac5f](https://github.com/gulpjs/vinyl-fs/commit/60dac5fa38c3470556d987b01405d3ccca6af9ec) remove async dep (@contra)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.src" id="apidoc.element.vinyl-fs.src">
        function <span class="apidocSignatureSpan">vinyl-fs.</span>src
        <span class="apidocSignatureSpan">(glob, opt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function src(glob, opt) {
  var options = assign({
    read: true,
    buffer: true,
    stripBOM: true,
    sourcemaps: false,
    passthrough: false,
    followSymlinks: true,
  }, opt);

  // Don't pass `read` option on to through2
  var read = options.read !== false;
  options.read = undefined;

  var inputPass;

  if (!isValidGlob(glob)) {
    throw new Error('Invalid glob argument: ' + glob);
  }

  var globStream = gs.create(glob, options);

  var outputStream = globStream
    .pipe(wrapWithVinylFile(options));

  if (options.since != null) {
    outputStream = outputStream
      .pipe(filterSince(options.since));
  }

  if (read) {
    outputStream = outputStream
      .pipe(getContents(options));
  }

  if (options.passthrough === true) {
    inputPass = through2.obj(options);
    outputStream = duplexify.obj(inputPass, merge(outputStream, inputPass));
  }
  if (options.sourcemaps === true) {
    outputStream = outputStream
      .pipe(sourcemaps.init({ loadMaps: true }));
  }
  globStream.on('error', outputStream.emit.bind(outputStream, 'error'));
  return outputStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var vfs = require('vinyl-fs');

var log = function(file, cb) {
  console.log(file.path);
  cb(null, file);
};

vfs.<span class="apidocCodeKeywordSpan">src</span>(['./js/**/*.js', '!./js/vendor/*.js'])
  .pipe(map(log))
  .pipe(vfs.dest('./output'));
```

## API

### `src(globs[, options])`
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.symlink" id="apidoc.element.vinyl-fs.symlink">
        function <span class="apidocSignatureSpan">vinyl-fs.</span>symlink
        <span class="apidocSignatureSpan">(outFolder, opt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function symlink(outFolder, opt) {
  function linkFile(file, enc, cb) {
    var srcPath = file.path;
    var symType = (file.isDirectory() ? 'dir' : 'file');
    prepareWrite(outFolder, file, opt, function(err, writePath) {
      if (err) {
        return cb(err);
      }
      fs.symlink(srcPath, writePath, symType, function(err) {
        if (err &amp;&amp; err.code !== 'EEXIST') {
          return cb(err);
        }
        cb(null, file);
      });
    });
  }

  var stream = through2.obj(opt, linkFile);
  // TODO: option for either backpressure or lossy
  stream.resume();
  return stream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Type: `String`

Default: `process.cwd()`

##### `options.base`

The folder relative to the cwd. This is used to determine the file names when saving in `.<span class="apidocCodeKeywordSpan">symlink
</span>()`. Can also be a function that takes in a file and returns a folder path.

Type: `String` or `Function`

Default: The `cwd` resolved to the folder path.

##### `options.dirMode`
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.vinyl-fs.fileOperations" id="apidoc.module.vinyl-fs.fileOperations">module vinyl-fs.fileOperations</a></h1>


    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.closeFd" id="apidoc.element.vinyl-fs.fileOperations.closeFd">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>closeFd
        <span class="apidocSignatureSpan">(propagatedErr, fd, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function closeFd(propagatedErr, fd, callback) {
  if (typeof fd !== 'number') {
    return callback(propagatedErr);
  }

  fs.close(fd, onClosed);

  function onClosed(closeErr) {
    if (propagatedErr || closeErr) {
      return callback(propagatedErr || closeErr);
    }

    callback();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  flag: file.flag,
};

fo.writeFile(writePath, file.contents, opt, onWriteFile);

function onWriteFile(writeErr, fd) {
  if (writeErr) {
    return fo.<span class="apidocCodeKeywordSpan">closeFd</span>(writeErr, fd, written);
  }

  fo.updateMetadata(fd, file, onUpdate);
}

function onUpdate(statErr, fd) {
  fo.closeFd(statErr, fd, written);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.getModeDiff" id="apidoc.element.vinyl-fs.fileOperations.getModeDiff">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>getModeDiff
        <span class="apidocSignatureSpan">(fsMode, vinylMode)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getModeDiff(fsMode, vinylMode) {
  var modeDiff = 0;

  if (typeof vinylMode === 'number') {
    modeDiff = (vinylMode ^ fsMode) &amp; MASK_MODE;
  }

  return modeDiff;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.getTimesDiff" id="apidoc.element.vinyl-fs.fileOperations.getTimesDiff">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>getTimesDiff
        <span class="apidocSignatureSpan">(fsStat, vinylStat)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getTimesDiff(fsStat, vinylStat) {

  if (!isValidDate(vinylStat.mtime)) {
    return;
  }

  if (isEqual(vinylStat.mtime, fsStat.mtime) &amp;&amp;
      isEqual(vinylStat.atime, fsStat.atime)) {
    return;
  }

  var atime;
  if (isValidDate(vinylStat.atime)) {
    atime = vinylStat.atime;
  } else {
    atime = fsStat.atime;
  }

  if (!isValidDate(atime)) {
    atime = undefined;
  }

  var timesDiff = {
    mtime: vinylStat.mtime,
    atime: atime,
  };

  return timesDiff;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.isOwner" id="apidoc.element.vinyl-fs.fileOperations.isOwner">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>isOwner
        <span class="apidocSignatureSpan">(fsStat)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isOwner(fsStat) {
  var hasGetuid = (typeof process.getuid === 'function');
  var hasGeteuid = (typeof process.geteuid === 'function');

  // If we don't have either, assume we don't have permissions.
  // This should only happen on Windows.
  // Windows basically noops fchmod and errors on futimes called on directories.
  if (!hasGeteuid &amp;&amp; !hasGetuid) {
    return false;
  }

  var uid;
  if (hasGeteuid) {
    uid = process.geteuid();
  } else {
    uid = process.getuid();
  }

  if (fsStat.uid !== uid &amp;&amp; uid !== 0) {
    return false;
  }

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.updateMetadata" id="apidoc.element.vinyl-fs.fileOperations.updateMetadata">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>updateMetadata
        <span class="apidocSignatureSpan">(fd, file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function updateMetadata(fd, file, callback) {

  fs.fstat(fd, onStat);

  function onStat(err, stat) {
    if (err) {
      return callback(err, fd);
    }

    // Check if mode needs to be updated
    var modeDiff = getModeDiff(stat.mode, file.stat.mode);

    // Check if atime/mtime need to be updated
    var timesDiff = getTimesDiff(stat, file.stat);

    // Set file.stat to the reflect current state on disk
    assign(file.stat, stat);

    // Nothing to do
    if (!modeDiff &amp;&amp; !timesDiff) {
      return callback(null, fd);
    }

    // Check access, `futimes` and `fchmod` only work if we own the file,
    // or if we are effectively root.
    if (!isOwner(stat)) {
      return callback(null, fd);
    }

    if (modeDiff) {
      return mode();
    }
    times();

    function mode() {
      var mode = stat.mode ^ modeDiff;

      fs.fchmod(fd, mode, onFchmod);

      function onFchmod(fchmodErr) {
        if (!fchmodErr) {
          file.stat.mode = mode;
        }
        if (timesDiff) {
          return times(fchmodErr);
        }
        callback(fchmodErr, fd);
      }
    }

    function times(fchmodErr) {
      fs.futimes(fd, timesDiff.atime, timesDiff.mtime, onFutimes);

      function onFutimes(futimesErr) {
        if (!futimesErr) {
          file.stat.atime = timesDiff.atime;
          file.stat.mtime = timesDiff.mtime;
        }
        callback(fchmodErr || futimesErr, fd);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  fo.writeFile(writePath, file.contents, opt, onWriteFile);

  function onWriteFile(writeErr, fd) {
    if (writeErr) {
      return fo.closeFd(writeErr, fd, written);
    }

    fo.<span class="apidocCodeKeywordSpan">updateMetadata</span>(fd, file, onUpdate);
  }

  function onUpdate(statErr, fd) {
    fo.closeFd(statErr, fd, written);
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.vinyl-fs.fileOperations.writeFile" id="apidoc.element.vinyl-fs.fileOperations.writeFile">
        function <span class="apidocSignatureSpan">vinyl-fs.fileOperations.</span>writeFile
        <span class="apidocSignatureSpan">(path, data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function writeFile(path, data, options, callback) {
  if (typeof options === 'function') {
    callback = options;
    options = {};
  }

  if (!Buffer.isBuffer(data)) {
    callback(new TypeError('Data must be a Buffer'));
    return;
  }

  if (!options) {
    options = {};
  }

  // Default the same as node
  var mode = options.mode || DEFAULT_FILE_MODE;
  var flag = options.flag || 'w';
  var position = APPEND_MODE_REGEXP.test(flag) ? null : 0;

  fs.open(path, flag, mode, onOpen);

  function onOpen(err, fd) {
    if (err) {
      return onComplete(err);
    }

    fs.write(fd, data, 0, data.length, position, onComplete);

    function onComplete(err) {
      callback(err, fd);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function writeBuffer(writePath, file, written) {
  var opt = {
mode: file.stat.mode,
flag: file.flag,
  };

  fo.<span class="apidocCodeKeywordSpan">writeFile</span>(writePath, file.contents, opt, onWriteFile);

  function onWriteFile(writeErr, fd) {
if (writeErr) {
  return fo.closeFd(writeErr, fd, written);
}

fo.updateMetadata(fd, file, onUpdate);
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>